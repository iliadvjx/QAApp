"use strict";var data=require("./data.json");const propGenerator=require("./propGenerator"),{ipcRenderer:ipcRenderer}=require("electron"),validator=require("validator"),fs=require("fs"),server=require("./svReq"),$=require("jquery");$(()=>{$(".resultBtn").hide(),$(".rel").hide(),$("#guide").click(()=>{location.href="Guide.html"}),$("#contact").click(()=>{location.href="contact.html"})});let I,E,N,S,F,T,P,J,l1,l2,l3,l4,btn_bool,start=0,end=6;I=E=N=S=F=T=P=J=0,$(".start-btn").on("click",()=>{$("footer").css({backgroundImage:"unset",height:"unset"}),$("footer span").css({color:"rgba(78, 78, 78, 0.541)"}),$(".rel").show(),$(".next-btn").show(),$(".start-btn").hide(),$(".titr").hide(),$(".all-btn").remove(),onMenuClick(),$(".navbar a").removeAttr("href");for(var e=start;e<end;e++)$(".qa-box").append(qsGenerator(data[e])).scrollTop(0),$(".q").hide();$(".q").fadeIn(200)});var darsads=[];let emails;function goOnResult(){E>I?(l1="E",darsads.push(Math.round(E/32*100)),console.log(Math.round(E/32*100),"E")):(l1="I",darsads.push(Math.round(I/37*100)),console.log(Math.round(I/37*100),"I")),S>N?(l2="S",darsads.push(Math.round(S/27*100)),console.log(Math.round(S/27*100),"S")):(l2="N",darsads.push(Math.round(N/28*100)),console.log(Math.round(N/28*100),"N")),T>F?(l3="T",darsads.push(Math.round(T/24*100)),console.log(Math.round(T/24*100),"T")):(l3="F",darsads.push(Math.round(F/28*100)),console.log(Math.round(F/28*100),"F")),J>P?(l4="J",darsads.push(Math.round(J/28*100)),console.log(Math.round(J/28*100),"J")):(l4="P",darsads.push(Math.round(P/31*100)),console.log(Math.round(P/31*100),"P")),darsads=darsads.reverse(),$(".qa-box").removeClass("grid-container"),$(".resultBtn").show();var e=`\n    <div class="getEmail" >\n\n            <h3>\n                    لطفا ابتدا ایمیل خود را وارد کنید<br/>\n                    \n                </h3>\n\n                <input type="text" class="email-txt">\n                <br/>\n   \n        ${enableCheckBox()}\n\n\n        <div class="resultBtn">\n        <button class="disable-btn-res" style="vertical-align:middle"><span>نتایج </span></button>\n   </div>\n    </div>`;$(".qa-box").append(e),btn_bool=!1;let a=!0;$(".resultBtn").on("click",()=>{if(btn_bool)if(!0===navigator.onLine){a&&(fs.writeFileSync(__dirname+"/data/email.txt",$(".email-txt").val()),emails=$(".email-txt").val()),$(".resultBtn").hide(),$(".res-btn").show(),$(".getEmail").remove(),add_flag(),onHoverWord(),server(emails,l1+l2+l3+l4,window.screen.availWidth,window.screen.availHeight),prvBtn.addClass("disable"),nextBtn.addClass("enable")}else alert("لطفا ابتدا به اینترنت متصل شوید!")}),$("#j1").on("change",e=>{event.target.checked?($(".resultBtn button").addClass("enable-btn-res").removeClass("disable-btn-res"),$(".email-txt").attr("disabled","disabled"),btn_bool=!0,a=!1,emails=fs.readFileSync(__dirname+"/data/email.txt").toString()):($(".resultBtn button").addClass("disable-btn-res").removeClass("enable-btn-res"),btn_bool=!1,a=!0,$(".email-txt").removeAttr("disabled"))}),document.querySelector(".email-txt").addEventListener("keyup",function(e){validator.isEmail($(".email-txt").val())?($(".resultBtn button").addClass("enable-btn-res").removeClass("disable-btn-res"),btn_bool=!0):($(".email-txt").val().length,$(".resultBtn button").addClass("disable-btn-res").removeClass("enable-btn-res"))})}$(".next-btn").on("click",()=>{if(end<88&&start<90){for(var e=0,a=start;a<end;a++)for(var t=0;t<2;t++)$(`[name="qa${a+1}"]`)[t].checked&&e++;if(87==end&&3===e&&(e=6),6===e){for(a=start;a<end;a++){var s;for(t=0;t<2;t++)if($(`[name="qa${a+1}"]`)[t].checked){s=$(`[name="qa${a+1}"]`)[t].id;break}var n=data[a].id;n<=25?"j1"==s?E+=data[a].nomre1:"j2"==s&&(I+=data[a].nomre2):n>25&&n<=44?"j1"==s?S+=data[a].nomre1:"j2"==s&&(N+=data[a].nomre2):n>44&&n<=68?"j1"==s?T+=data[a].nomre1:"j2"==s&&(F+=data[a].nomre2):n>68&&n<=87&&("j1"==s?J+=data[a].nomre1:"j2"==s&&(P+=data[a].nomre2))}87==end&&(end+=6),$(".q").remove(),end+=6,90==(start+=6)&&($(".next-btn").remove(),goOnResult()),end>87&&(end=87);for(a=start;a<end;a++)$(".qa-box").append(qsGenerator(data[a])),$(".q").hide(),$("body").scrollTop(0);$(".q").fadeIn(200),console.log(E,I,N,S,F,T,P,J)}else alert("لطفا ابتدا به تمامی سوالات پاسخ دهید!")}});const qsGenerator=e=>{return`<div class="q ">     \n            <div class="question">\n                <span class="qid">${e.id} - </span>\n                ${$.trim(e.soal)}\n            </div>\n            <div class="radioS">\n            <label class="jlb">${$.trim(e.javab1)}\n                <input type="radio" id="j1"name="qa${e.id}" >\n                <span class="checkmark"></span>\n                </label>\n            <br>\n            <label class="jlb">${$.trim(e.javab2)}\n            <input type="radio" id="j2"  name="qa${e.id}" > \n            <span class="checkmark"></span>\n            </label>\n            </div> \n            </div>`};function enableCheckBox(){try{const e=fs.readFileSync(__dirname+"/data/email.txt");return 0!==e.length?`\n            <div class="email-qs">\n            \n            <label class="jlb">\n           \n            <input type="checkbox" id="j1">\n            <span class="checkmark"></span>\n                </label>\n                <p>\n                آیا میخواهید با ایمیل ${e} ادامه دهید؟ \n            </p>\n\n            </div>\n            `:""}catch(e){console.log(e)}}var prvBtn=$(".previous");let nextBtn=$(".next"),avatarsTexts=propGenerator.pictures_Text;$(".next").on("click",()=>{prvBtn.hasClass("disable")&&($("#wrapper").hide(),$("#wrapper").removeClass("animated zoomIn"),$(".next").addClass("disable ").removeClass("enable"),$(".res-info2").hide(),$(".qa-box").append(`\n        <div class="pictures"> \n\n        <div class="picture1"> \n        <img src="data/pictures/${l1+l2+l3+l4}.png" width="205px" height="270px">\n        <div class="imgtxt"> \n        ${avatarsTexts[l1+l2+l3+l4].avatar}\n        </div>\n        </div>\n\n        <div class="picture2 "> \n        <img src="data/jobs/${l1+l2+l3+l4}.png" >\n        <div class="imgtxt"> \n        ${avatarsTexts[l1+l2+l3+l4].job}\n        </div>\n        </div>\n\n        <div class="picture3"> \n        <img src="data/sports/${l1+l2+l3+l4}.png">\n        <div class="imgtxt">\n        ${avatarsTexts[l1+l2+l3+l4].sport}\n        </div>\n        </div>\n\n        </div>\n\n    `),$(".pictures > div").addClass("animated fadeInDown"),prvBtn.addClass("enable").removeClass("disable"))}),$(".reloader").click(()=>{ipcRenderer.send("reload")}),prvBtn.click(()=>{nextBtn.hasClass("disable")&&($(".pictures").remove(),$(".res-info2").show(),add_flag(),nextBtn.addClass("enable").removeClass("disable"),prvBtn.addClass("disable").removeClass("enable"))});let flagDescrib=propGenerator.flagObj,randomIndex=propGenerator.generated,prop=$("#prop");const onHoverWord=()=>{$(".progress").hover(function(e){$(".propList").remove();var a=$(this).data("letter");prop.append('<ul class="propList"> </ul>');for(var t=$(".propList"),s=0;s<6;s++){var n=s+1;t.append("<li> "+n+". "+$.trim(flagDescrib[a].property[randomIndex.get(a)[s]].matn)+"<li>")}prop.removeClass("hide").addClass("show").css({top:e.pageY+"px",left:e.pageX+"px"}).hide(),prop.fadeIn(200)},function(){$(".propList").remove(),prop.removeClass("show").addClass("hide")})};let wrapBool=!1;const add_flag=async()=>{const e=[l4,l3,l2,l1];if(!wrapBool){const e=await progressBarRes();$(".qa-box").append(e),$(".qa-box").append('<p class="res-info2" >برای شناختن بهتر خود به صفحه بعد مراجعه کنید!</p>')}$("#wrapper").show(50,()=>{$(".progress").each(function(a){let t=$(this);t.data("letter",e[a]),t.children(".value").text(darsads[a]+"%"),t.children(".text").text(e[a]),t.data("progress",darsads[a]),t.children(".fill").attr("style","stroke-dashoffset: "+(100-darsads[a])/100*-219.99078369140625),t.children(".fill").css({stroke:flagDescrib[e[a]].color})}),onHoverWord()})},onMenuClick=()=>{$("#guide").click(()=>{window.confirm("آیا مطئنید میخواهید از قسمت آزمون خارج شوید؟")&&(location.href="Guide.html")}),$("#contact").click(()=>{confirm("آیا مطئنید میخواهید از قسمت آزمون خارج شوید؟")&&(location.href="contact.html")})},progressBarRes=()=>(wrapBool=!0,new Promise((e,a)=>{e('\n            <div id="wrapper" class="animated zoomIn">\n            <div class="center">\n            <svg class="progress blue noselect" data-letter="X" data-progress="65" x="0px" y="0px"\n                viewBox="0 0 80 80">\n                <path class="track" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <path class="fill" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <text class="value" id="val4" x="50%" y="55%">0%</text>\n                <text class="text" id="letter4" x="50%" y="115%">Blue</text>\n            </svg>\n            <svg class="progress green noselect" data-letter="X" data-letter data-progress="33" x="0px" y="0px"\n                viewBox="0 0 80 80">\n                <path class="track" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <path class="fill" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <text class="value" id="val3" x="50%" y="55%">0%</text>\n                <text class="text" id="letter3" x="50%" y="115%">Green</text>\n            </svg>\n\n            <svg class="progress green noselect" data-letter="X" data-progress="50" x="0px" y="0px"\n                viewBox="0 0 80 80">\n                <path class="track" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <path class="fill" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <text class="value" id="val2" x="50%" y="55%">0%</text>\n                <text class="text" id="letter2" x="50%" y="115%">Green</text>\n            </svg>\n\n            <svg class="progress blue noselect" data-letter="X" data-progress="70" x="0px" y="0px"\n                viewBox="0 0 80 80">\n                <path class="track" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <path class="fill" d="M5,40a35,35 0 1,0 70,0a35,35 0 1,0 -70,0" />\n                <text class="value" id="val1" x="50%" y="55%">0%</text>\n                <text class="text" id="letter1" x="50%" y="115%">Green</text>\n            </svg>\n            </div>\n            <p class="res-info1" >برای دیدن برخی از ویژگی های خود موس را بروی درصد ها ببرید!</p>\n        </div>\n            ')}));